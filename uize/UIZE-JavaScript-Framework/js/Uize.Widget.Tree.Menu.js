/*
	UIZE JAVASCRIPT FRAMEWORK 2012-01-10

	http://www.uize.com/reference/Uize.Widget.Tree.Menu.html
	Available under MIT License or GNU General Public License -- http://www.uize.com/license.html
*/
Uize.module({name:'Uize.Widget.Tree.Menu',required:'Uize.Node',builder:function(d_a){var d_b,d_c=true,d_d=false,d_e=Uize.Node;var d_f=Uize.pathToResources+'Uize_Widget_Tree_Menu/',d_g=10000;var d_h=d_a.subclass(d_b,function(){var d_i=this;d_i.wire('Changed.items',function(){d_i.setExpandedDepth(0)});}),d_j=d_h.prototype;d_j.d_k=function(d_l){var d_i=this,d_m=d_i.d_m;if(!d_m[d_l]){Uize.forEach(d_l?d_i.getItemFromSpecifier(d_l).items:d_i.get('items'),function(d_n,d_o){var d_p=d_l+(d_l&&'x')+d_o;d_i.wireNode(d_p+'TitleLink','mouseover',function(){d_i.collapseAllBut(d_p)});});function d_q(){if(d_i.d_r)d_i.d_r=clearTimeout(d_i.d_r);}function d_s(){d_q();d_i.setExpandedDepth(0);}function d_t(){d_q();d_i.d_r=setTimeout(d_s,d_i.d_u);}d_i.wireNode(d_l+(d_l&&'Children'),{mouseover:d_q,mouseout:d_t,click:d_s});d_m[d_l]=d_c;}};d_j.d_v=function(d_n,d_w){var d_i=this;return((d_w?d_i.d_x:d_i.d_y)+(d_n.expanded?(' '+(d_w?d_i.d_z:d_i.d_A)):'')+(d_h.itemHasChildren(d_n)?(' '+(d_w?d_i.d_B:d_i.d_C)):''));};
d_j.setItemExpanded=function(d_l,d_D){var d_i=this,d_n=d_i.getItemFromSpecifier(d_l);if(typeof d_D!='boolean')d_D=d_n.expanded===d_d;if(d_D!=d_n.expanded){var d_w=d_l.split(d_i.get('itemDelimiter')).length-1;d_n.expanded=d_D;d_i.setNodeProperties(d_l+'TitleLink',{className:d_i.d_v(d_n,d_w)});d_D&&d_i.d_k(d_l);if(d_h.itemHasChildren(d_n)){var d_E=d_i.getNode(d_l+'Children');d_i.displayNode(d_E,d_D);if(d_D){d_i.globalizeNode(d_E);d_i.setNodeStyle(d_E,{zIndex:d_g+d_w});d_e.setAbsPosAdjacentTo(d_E,d_i.getNode(d_l+'TitleLink'),d_w?'x':'y');}}}};d_j.wireUi=function(){var d_i=this;if(!d_i.isWired){d_i.d_m={};d_i.d_k('');d_a.prototype.wireUi.call(d_i);}};d_h.registerProperties({d_u:{name:'dismissDelay',value:400},d_F:'menuCssClass',d_G:'menuDividerClass',d_A:'menuItemActiveCssClass',d_C:'menuItemChildrenIndicatorCssClass',d_y:'menuItemCssClass',d_H:'subMenuCssClass',d_I:'subMenuDividerClass',d_z:'subMenuItemActiveCssClass',d_B:'subMenuItemChildrenIndicatorCssClass',d_x:'subMenuItemCssClass'});d_h.set({html:{
process:function(input){var d_i=this,d_J=input.idPrefix,d_K=[];d_i.traverseTree({itemHandler:function(d_n,d_l,d_w){d_K.push(d_h.itemIsDivider(d_n)?('<div class="'+(d_w?input.subMenuDividerClass:input.menuDividerClass)+'" href="javascript://">&nbsp;</div>'):('<a id="'+d_J+'-'+d_l+'TitleLink" class="'+d_i.d_v(d_n,d_w)+'" href="'+(d_n.link||'javascript://')+'"'+(d_n.link?'':' style="cursor:default;"')+'>'+d_n.title+'</a>'));},beforeSubItemsHandler:function(d_n,d_l,d_w){d_K.push('<div id="'+d_J+'-'+d_l+'Children" class="'+input.subMenuCssClass+'">');},afterSubItemsHandler:function(){d_K.push('</div>\n')}});return('<div id="'+d_J+'" class="'+input.menuCssClass+'">'+d_K.join('')+'<br style="clear:both;"/>'+'</div>\n');}}});return d_h;}});