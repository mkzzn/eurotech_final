/*
	UIZE JAVASCRIPT FRAMEWORK 2012-01-10

	http://www.uize.com/reference/Uize.Widget.Pagination.html
	Available under MIT License or GNU General Public License -- http://www.uize.com/license.html
*/
Uize.module({name:'Uize.Widget.Pagination',required:['Uize.Widget.Button','Uize.Node','Uize.Node.Classes'],builder:function(d_a){var d_b=d_a.subclass(null,function(){var d_c=this;d_c.d_d('prev',function(){d_c.d_e(d_c.d_f-1)});d_c.d_d('next',function(){d_c.d_e(d_c.d_f+1)});}),d_g=d_b.prototype;d_g.d_d=Uize.Widget.Button.addChildButton;d_g.d_h=function(){return Math.ceil(this.d_i/this.d_j)};d_g.d_k=function(){var d_c=this,d_f=d_c.d_f,d_l=d_c.d_l,d_m=d_c.d_h(),d_n=1+(d_c.d_o&&d_f>1),d_p=d_m-(d_c.d_q&&d_f<d_m),d_r=Math.ceil(d_l/2),d_s=d_f-d_r+1,d_t=d_f+(d_l-d_r);if(d_s>=d_n&&d_t<=d_p)return d_s;else if(d_s>=d_n)return Math.max(d_n,d_p-d_l+1);else return d_n;};d_g.d_e=function(d_u){this.set({d_f:d_u})};d_g.d_v=function(){var d_c=this,d_w=d_c.children,d_f=d_c.d_f,d_m=d_c.d_h(),d_x=d_m>1,d_i=d_c.d_i;if(d_c.isWired){d_c.displayNode('',d_i>0);d_c.displayNode('paginationShell',d_x);d_c.setNodeInnerHtml('displayShell',d_c.localize('displayInfo',{number:(d_f-1)*d_c.d_j+1,toNumber:Math.min(d_i,d_f*d_c.d_j),
total:d_c.localize('numResultsDisplay',{numResults:d_c.d_i})||d_i}));if(d_x){function d_y(d_z,d_A){d_w[d_z].set({enabled:d_A?'inherit':d_A})}function d_B(d_z,d_C){d_w[d_z].displayNode('',d_C)}function d_D(d_z,d_E){d_w[d_z].set({text:d_E})}d_y('prev',d_f>1);d_y('next',d_f<d_m);d_B('first',d_f>1);d_B('last',d_f<d_m);d_D('last',d_m);var d_F=d_c.d_k();d_c.displayNode('less',d_F>(1+d_c.d_o));d_c.displayNode('more',(d_F+d_c.d_l)<(d_m-d_c.d_q));for(var d_G= -1;++d_G<d_c.d_l;){var d_H='page'+d_G,d_I=d_w[d_H].getNode(),d_u=d_F+d_G,d_J=d_u==d_f;d_D(d_H,d_J?d_c.localize('selectedPage',{page:d_u})||d_u:d_u);d_B(d_H,d_u==d_f||d_u<=(d_m-d_c.d_q));Uize.Node.Classes.setState(d_I,d_c.d_K,d_J);}}}};d_g.updateUi=function(){var d_c=this;if(d_c.isWired){d_c.d_v();d_a.prototype.updateUi.call(d_c);}};d_g.wireUi=function(){var d_c=this;if(!d_c.isWired){function d_L(d_M){return!!Uize.Node.getById(d_c.get('idPrefix')+'_'+d_M)}d_c.d_o=d_L('first');d_c.d_q=d_L('last');d_c.d_l= -1;while(d_L('page'+ ++d_c.d_l));d_c.d_o
&&d_c.d_d('first',function(){d_c.d_e(1)});d_c.d_q&&d_c.d_d('last',function(){d_c.d_e(d_c.d_h())});function d_N(d_G){d_c.d_d('page'+d_G,function(){d_c.d_e(d_c.d_k()+d_G)})}for(var d_G= -1;++d_G<d_c.d_l;)d_N(d_G);d_a.prototype.wireUi.call(d_c);}};d_b.registerProperties({d_K:{name:'classSelected',value:'selected'},d_i:{name:'numResults',onChange:[d_g.d_h,d_g.d_v]},d_j:{name:'pageSize',conformer:function(d_O){return d_O?d_O:30},onChange:[d_g.d_h,d_g.d_v],value:30},d_f:{name:'value',conformer:function(d_P){var d_m=this.d_h();return d_P?(!d_m||d_P<d_m?d_P:d_m):1},onChange:d_g.d_v,value:1}});return d_b;}});