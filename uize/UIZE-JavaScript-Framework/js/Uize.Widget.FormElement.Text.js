/*
	UIZE JAVASCRIPT FRAMEWORK 2012-01-10

	http://www.uize.com/reference/Uize.Widget.FormElement.Text.html
	Available under MIT License or GNU General Public License -- http://www.uize.com/license.html
*/
Uize.module({name:'Uize.Widget.FormElement.Text',required:'Uize.Node',builder:function(d_a){var d_b=typeof document!='undefined'&&'placeholder'in document.createElement('input');var d_c=d_a.subclass(null,function(){var d_d=this;d_d.wire('Changed.focused',function(){var d_e=d_d.get('focused'),d_f=d_d.d_f,d_g=d_d.get('value');if(d_f&& !d_b){function d_h(d_i){d_d.isWired&&d_d.setNodeValue('input',d_i)}if(d_e&&d_g==d_f)d_h('');else if(!d_e&& !d_g)d_h(d_f)}if(d_d.isWired&&d_e){var d_j=d_d.getNode('input'),d_k=d_d.getNodeValue(d_j),d_l=d_k?d_k.length:0;if(d_l>0){if(d_j.createTextRange){var d_m=d_j.createTextRange();d_m.move('character',d_l);d_m.select();}else if(d_j.setSelectionRange)d_j.setSelectionRange(d_l,d_l);}}});d_d.d_n();}),d_o=d_c.prototype;d_o.d_n=function(){var d_d=this;d_d.d_p=[function(d_g){var d_q=d_g+'',d_l=d_g!=null?d_q.length:0;return d_l>=d_d.d_r&&d_l<=d_d.d_s;}];};d_o.d_t=function(){this.isWired&&d_b&&this.setNodeProperties('input',{placeholder:this.d_f})};d_o.checkIsEmpty=function(){
return d_a.prototype.checkIsEmpty.call(this)||this.get('value')==this.d_f};d_o.getCaretPosition=function(){var d_d=this,d_u=d_d.getNode('input');if(d_d.isWired&&d_d.get('focused')){if(Uize.Node.isIe){var d_v=document.selection.createRange();d_v.moveStart('character',-d_d.get('tentativeValue').length);return d_v.text.length;}else{return d_u.selectionStart;}}else{return-1;}};d_o.setCaretPosition=function(d_w){var d_d=this,d_u=d_d.getNode('input');if(d_d.isWired&&d_d.get('focused')){if(Uize.Node.isIe){var d_m=d_u.createTextRange();d_m.collapse(true);d_m.moveEnd('character',d_w);d_m.moveStart('character',d_w);d_m.select();}else d_u.setSelectionRange(d_w,d_w);}};d_o.getMoreValidators=function(){return this.d_p};d_o.updateUi=function(){if(this.isWired){this.d_t();d_a.prototype.updateUi.call(this);}};d_o.wireUi=function(){var d_d=this;if(!d_d.isWired){var d_f=d_d.d_f,d_u=d_d.getNode('input');if(d_f){if(d_b)d_d.setNodeProperties(d_u,{placeholder:d_f});else d_d.set('value',d_f);}d_a.prototype.wireUi.call(d_d);}};
d_c.registerProperties({d_f:{name:'placeholder|defaultValue',onChange:d_o.d_t,value:''},d_r:{name:'minLength',onChange:d_o.d_n,value:0},d_s:{name:'maxLength',onChange:d_o.d_n,value:32767}});return d_c;}});